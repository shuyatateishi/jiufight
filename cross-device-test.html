<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ åˆ¥ç«¯æœ«é–“åŒæœŸãƒ†ã‚¹ãƒˆ - Jiufight</title>
    <meta name="robots" content="noindex, nofollow">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸŒ</text></svg>">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        .test-container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .device-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #2196f3;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 10px;
            background: #f9f9f9;
        }
        .test-result {
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            font-weight: 500;
        }
        .success { background: #d4edda; color: #155724; border: 2px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 2px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 2px solid #bee5eb; }
        .warning { background: #fff3cd; color: #856404; border: 2px solid #ffeaa7; }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        button:hover { 
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        button:active { transform: translateY(0); }
        
        .urgent-btn {
            background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
            font-size: 1.1em;
            padding: 15px 30px;
        }
        
        .log {
            background: #2d3748;
            color: #e2e8f0;
            border: 2px solid #4a5568;
            padding: 15px;
            height: 300px;
            overflow-y: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            white-space: pre-wrap;
            border-radius: 8px;
        }
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .status-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .qr-section {
            text-align: center;
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px dashed #2196f3;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="header">
            <h1>ğŸŒ åˆ¥ç«¯æœ«é–“ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸãƒ†ã‚¹ãƒˆ</h1>
            <p>ã“ã®ãƒšãƒ¼ã‚¸ã§é¸æ‰‹ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´ã—ã€ä»–ã®ç«¯æœ«ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®åæ˜ ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™</p>
        </div>
        
        <div class="device-info">
            <h3>ğŸ“± ç¾åœ¨ã®ç«¯æœ«æƒ…å ±</h3>
            <div id="device-info">èª­ã¿è¾¼ã¿ä¸­...</div>
        </div>
        
        <div class="qr-section">
            <h3>ğŸ“± ä»–ã®ç«¯æœ«ã§ãƒ†ã‚¹ãƒˆã™ã‚‹å ´åˆ</h3>
            <p>ã“ã®URLã‚’ä»–ã®ç«¯æœ«ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã„ã¦ãã ã•ã„ï¼š</p>
            <code id="test-url" style="background: #f0f0f0; padding: 10px; border-radius: 5px; display: inline-block;"></code>
            <br><br>
            <small>ğŸ’¡ ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã€ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã€åˆ¥ã®PCã€åˆ¥ã®ãƒ–ãƒ©ã‚¦ã‚¶ãªã©ã€ç•°ãªã‚‹ç«¯æœ«ã§é–‹ã„ã¦ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„</small>
        </div>
        
        <div class="test-section">
            <h2>ğŸš€ ã‚¯ãƒ­ã‚¹ãƒ‡ãƒã‚¤ã‚¹åŒæœŸãƒ†ã‚¹ãƒˆ</h2>
            <p>ä»¥ä¸‹ã®ãƒœã‚¿ãƒ³ã§é¸æ‰‹ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´ã—ã€ä»–ã®ç«¯æœ«ã§å³åº§ã«åæ˜ ã•ã‚Œã‚‹ã‹ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
            
            <button class="urgent-btn" onclick="performCrossDeviceTest()">
                ğŸ”¥ åˆ¥ç«¯æœ«åŒæœŸãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
            </button>
            <button onclick="createTestFighter()">ãƒ†ã‚¹ãƒˆé¸æ‰‹ä½œæˆ</button>
            <button onclick="updateTestFighter()">ãƒ†ã‚¹ãƒˆé¸æ‰‹æ›´æ–°</button>
            <button onclick="deleteTestFighter()">ãƒ†ã‚¹ãƒˆé¸æ‰‹å‰Šé™¤</button>
            <button onclick="checkSyncStatus()">åŒæœŸçŠ¶æ…‹ç¢ºèª</button>
            <button onclick="forceSyncCheck()">å¼·åˆ¶åŒæœŸãƒã‚§ãƒƒã‚¯</button>
            
            <div id="test-results"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“Š ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸãƒ¢ãƒ‹ã‚¿ãƒ¼</h2>
            <div class="status-grid">
                <div class="status-card">
                    <h4>ğŸ”§ ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹</h4>
                    <div id="system-status">ç¢ºèªä¸­...</div>
                </div>
                <div class="status-card">
                    <h4>ğŸ‘¥ é¸æ‰‹ãƒ‡ãƒ¼ã‚¿</h4>
                    <div id="fighter-status">ç¢ºèªä¸­...</div>
                </div>
                <div class="status-card">
                    <h4>â±ï¸ æœ€çµ‚æ›´æ–°</h4>
                    <div id="last-update">ç¢ºèªä¸­...</div>
                </div>
                <div class="status-card">
                    <h4>ğŸŒ åŒæœŸãƒãƒ¼ã‚«ãƒ¼</h4>
                    <div id="sync-marker">ç¢ºèªä¸­...</div>
                </div>
            </div>
            
            <button onclick="startRealtimeMonitor()">ğŸ“¡ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–é–‹å§‹</button>
            <button onclick="stopRealtimeMonitor()">â¹ï¸ ç›£è¦–åœæ­¢</button>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“ ãƒ­ã‚°</h2>
            <div id="test-log" class="log"></div>
            <button onclick="clearLog()">ãƒ­ã‚°ã‚¯ãƒªã‚¢</button>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“š ãƒ†ã‚¹ãƒˆæ‰‹é †</h2>
            <ol>
                <li><strong>è¤‡æ•°ç«¯æœ«ã§ã“ã®ãƒšãƒ¼ã‚¸ã‚’é–‹ã</strong> - PCã€ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã€ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆãªã©</li>
                <li><strong>ä¸€ã¤ã®ç«¯æœ«ã§ã€Œåˆ¥ç«¯æœ«åŒæœŸãƒ†ã‚¹ãƒˆå®Ÿè¡Œã€ã‚’ã‚¯ãƒªãƒƒã‚¯</strong></li>
                <li><strong>ä»–ã®ç«¯æœ«ã§å¤‰æ›´ãŒå³åº§ã«åæ˜ ã•ã‚Œã‚‹ã‹ç¢ºèª</strong></li>
                <li><strong>é¸æ‰‹ä¸€è¦§ãƒšãƒ¼ã‚¸ã‚„ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒšãƒ¼ã‚¸ã§ã‚‚ç¢ºèª</strong></li>
                <li><strong>åŒæ–¹å‘ãƒ†ã‚¹ãƒˆ</strong> - å„ç«¯æœ«ã‹ã‚‰å¤‰æ›´ã—ã¦ç›¸äº’åæ˜ ã‚’ãƒã‚§ãƒƒã‚¯</li>
            </ol>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <!-- Firebase Configuration -->
    <script src="firebase-config.js"></script>
    
    <!-- Database Sync System -->
    <script src="database-sync.js"></script>
    <script>
        let testLog = [];
        let monitorInterval = null;
        let updateCount = 0;
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            testLog.push(logEntry);
            
            const logElement = document.getElementById('test-log');
            logElement.textContent = testLog.join('\n');
            logElement.scrollTop = logElement.scrollHeight;
            
            console.log(logEntry);
        }
        
        function showResult(message, type) {
            const results = document.getElementById('test-results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${type}`;
            resultDiv.textContent = message;
            results.appendChild(resultDiv);
            
            // æœ€æ–°ã®çµæœã ã‘æ®‹ã™ï¼ˆæœ€å¤§5ä»¶ï¼‰
            const allResults = results.children;
            if (allResults.length > 5) {
                results.removeChild(allResults[0]);
            }
        }
        
        // åˆæœŸåŒ–
        function initialize() {
            log('åˆ¥ç«¯æœ«é–“åŒæœŸãƒ†ã‚¹ãƒˆã‚’åˆæœŸåŒ–ä¸­...');
            
            // ç¾åœ¨ã®URLã‚’è¡¨ç¤º
            document.getElementById('test-url').textContent = window.location.href;
            
            // ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±è¡¨ç¤º
            updateDeviceInfo();
            
            // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸã‚·ã‚¹ãƒ†ãƒ ã®çŠ¶æ…‹ç¢ºèª
            if (window.databaseSync) {
                log('âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸã‚·ã‚¹ãƒ†ãƒ ãŒåˆ©ç”¨å¯èƒ½');
                
                // é¸æ‰‹ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã®ç›£è¦–
                window.databaseSync.onFighterUpdate((updatedData) => {
                    log(`ğŸ”„ é¸æ‰‹ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã‚’æ¤œçŸ¥! é¸æ‰‹æ•°: ${updatedData.length}`);
                    showResult(`ğŸ”„ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°æ¤œçŸ¥: ${updatedData.length}äººã®é¸æ‰‹ãƒ‡ãƒ¼ã‚¿`, 'success');
                    updateStatusCards();
                });
                
                updateStatusCards();
            } else {
                log('âŒ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸã‚·ã‚¹ãƒ†ãƒ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                showResult('âŒ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼', 'error');
            }
        }
        
        function updateDeviceInfo() {
            const deviceInfo = {
                userAgent: navigator.userAgent,
                deviceId: window.databaseSync ? window.databaseSync.deviceId : 'ä¸æ˜',
                timestamp: new Date().toLocaleString(),
                syncSupport: !!window.databaseSync
            };
            
            document.getElementById('device-info').innerHTML = `
                <strong>ç«¯æœ«ID:</strong> ${deviceInfo.deviceId}<br>
                <strong>ãƒ–ãƒ©ã‚¦ã‚¶:</strong> ${getBrowserInfo()}<br>
                <strong>åŒæœŸã‚·ã‚¹ãƒ†ãƒ :</strong> ${deviceInfo.syncSupport ? 'âœ… åˆ©ç”¨å¯èƒ½' : 'âŒ åˆ©ç”¨ä¸å¯'}<br>
                <strong>æ¥ç¶šæ™‚åˆ»:</strong> ${deviceInfo.timestamp}
            `;
        }
        
        function getBrowserInfo() {
            const ua = navigator.userAgent;
            if (ua.includes('Chrome')) return 'Google Chrome';
            if (ua.includes('Firefox')) return 'Mozilla Firefox';
            if (ua.includes('Safari')) return 'Safari';
            if (ua.includes('Edge')) return 'Microsoft Edge';
            return 'ãã®ä»–ã®ãƒ–ãƒ©ã‚¦ã‚¶';
        }
        
        function updateStatusCards() {
            if (!window.databaseSync) return;
            
            const status = window.databaseSync.getSyncStatus();
            
            document.getElementById('system-status').innerHTML = `
                ç«¯æœ«ID: ${status.deviceId}<br>
                âœ… ã‚·ã‚¹ãƒ†ãƒ æ­£å¸¸å‹•ä½œä¸­
            `;
            
            document.getElementById('fighter-status').innerHTML = `
                é¸æ‰‹æ•°: ${status.localStorageData.fighters.count}äºº<br>
                ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º: ${(JSON.stringify(localStorage.getItem('fightersData') || '[]').length / 1024).toFixed(1)}KB
            `;
            
            const lastUpdate = status.localStorageData.fighters.timestamp 
                ? new Date(parseInt(status.localStorageData.fighters.timestamp)).toLocaleString()
                : 'æœªæ›´æ–°';
            document.getElementById('last-update').textContent = lastUpdate;
            
            const syncMarker = status.localStorageData.fighters.syncMarker;
            if (syncMarker) {
                try {
                    const marker = JSON.parse(syncMarker);
                    document.getElementById('sync-marker').innerHTML = `
                        æ›´æ–°ç«¯æœ«: ${marker.deviceId}<br>
                        åŒæœŸæ™‚åˆ»: ${new Date(marker.timestamp).toLocaleTimeString()}
                    `;
                } catch (e) {
                    document.getElementById('sync-marker').textContent = 'ã‚¨ãƒ©ãƒ¼';
                }
            }
        }
        
        // ãƒ¡ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        function performCrossDeviceTest() {
            log('ğŸ”¥ åˆ¥ç«¯æœ«é–“åŒæœŸãƒ†ã‚¹ãƒˆé–‹å§‹');
            showResult('ğŸš€ åˆ¥ç«¯æœ«åŒæœŸãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œä¸­...', 'info');
            
            if (!window.databaseSync) {
                showResult('âŒ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸã‚·ã‚¹ãƒ†ãƒ ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“', 'error');
                return;
            }
            
            // ãƒ†ã‚¹ãƒˆç”¨é¸æ‰‹ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
            const testFighter = {
                id: 88888,
                name: `ã‚¯ãƒ­ã‚¹ãƒ‡ãƒã‚¤ã‚¹ãƒ†ã‚¹ãƒˆé¸æ‰‹`,
                nickname: `ç«¯æœ«é–“åŒæœŸãƒ†ã‚¹ã‚¿ãƒ¼_${Date.now()}`,
                belt: 'black',
                weight: 'light',
                dojo: `${window.databaseSync.deviceId}_é“å ´`,
                wins: 777,
                losses: 0,
                bio: `åˆ¥ç«¯æœ«é–“åŒæœŸã®ãƒ†ã‚¹ãƒˆç”¨é¸æ‰‹ - ä½œæˆç«¯æœ«: ${window.databaseSync.deviceId}`,
                fullName: `ã‚¯ãƒ­ã‚¹ãƒ‡ãƒã‚¤ã‚¹å¤ªéƒ_${updateCount++}`,
                age: '25',
                occupation: 'åŒæœŸãƒ†ã‚¹ã‚¿ãƒ¼',
                location: `${getBrowserInfo()}ãƒ–ãƒ©ã‚¦ã‚¶`,
                experience: 'ç«¯æœ«é–“åŒæœŸæ­´1ç§’',
                specialty: 'ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸ',
                characteristic: 'ç¬æ™‚ã«ä»–ç«¯æœ«ã«ç¾ã‚Œã‚‹',
                motivation: 'å…¨ç«¯æœ«ã§åŒæœŸã•ã‚ŒãŸã„ï¼',
                testTimestamp: new Date().toISOString(),
                deviceOrigin: window.databaseSync.deviceId
            };
            
            // æ—¢å­˜ãƒ‡ãƒ¼ã‚¿å–å¾—
            let fightersData = [];
            const existingData = localStorage.getItem('fightersData');
            if (existingData) {
                fightersData = JSON.parse(existingData);
            }
            
            // ãƒ†ã‚¹ãƒˆé¸æ‰‹ã‚’è¿½åŠ /æ›´æ–°
            const existingIndex = fightersData.findIndex(f => f.id === 88888);
            if (existingIndex >= 0) {
                fightersData[existingIndex] = testFighter;
                log('ã‚¯ãƒ­ã‚¹ãƒ‡ãƒã‚¤ã‚¹ãƒ†ã‚¹ãƒˆé¸æ‰‹ã‚’æ›´æ–°');
            } else {
                fightersData.push(testFighter);
                log('ã‚¯ãƒ­ã‚¹ãƒ‡ãƒã‚¤ã‚¹ãƒ†ã‚¹ãƒˆé¸æ‰‹ã‚’è¿½åŠ ');
            }
            
            // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸã§ä¿å­˜
            window.databaseSync.updateFighters(fightersData);
            
            log(`âœ… ãƒ†ã‚¹ãƒˆé¸æ‰‹ã€Œ${testFighter.nickname}ã€ã‚’ä¿å­˜å®Œäº†`);
            showResult(`âœ… ãƒ†ã‚¹ãƒˆé¸æ‰‹ã‚’ä½œæˆãƒ»æ›´æ–°ã—ã¾ã—ãŸï¼ä»–ã®ç«¯æœ«ã§ç¢ºèªã—ã¦ãã ã•ã„`, 'success');
            
            updateStatusCards();
        }
        
        function createTestFighter() {
            performCrossDeviceTest();
        }
        
        function updateTestFighter() {
            log('ãƒ†ã‚¹ãƒˆé¸æ‰‹ã‚’æ›´æ–°ä¸­...');
            
            let fightersData = JSON.parse(localStorage.getItem('fightersData') || '[]');
            const testFighter = fightersData.find(f => f.id === 88888);
            
            if (testFighter) {
                testFighter.nickname = `æ›´æ–°ãƒ†ã‚¹ã‚¿ãƒ¼_${Date.now()}`;
                testFighter.motivation = `${new Date().toLocaleTimeString()}ã«æ›´æ–°ã•ã‚Œã¾ã—ãŸï¼`;
                testFighter.wins = testFighter.wins + 1;
                
                window.databaseSync.updateFighters(fightersData);
                log('âœ… ãƒ†ã‚¹ãƒˆé¸æ‰‹ã‚’æ›´æ–°ã—ã¾ã—ãŸ');
                showResult('âœ… ãƒ†ã‚¹ãƒˆé¸æ‰‹ã‚’æ›´æ–°ã—ã¾ã—ãŸ', 'success');
            } else {
                log('âš ï¸ ãƒ†ã‚¹ãƒˆé¸æ‰‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                showResult('âš ï¸ ãƒ†ã‚¹ãƒˆé¸æ‰‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚å…ˆã«ä½œæˆã—ã¦ãã ã•ã„', 'warning');
            }
        }
        
        function deleteTestFighter() {
            log('ãƒ†ã‚¹ãƒˆé¸æ‰‹ã‚’å‰Šé™¤ä¸­...');
            
            let fightersData = JSON.parse(localStorage.getItem('fightersData') || '[]');
            const originalLength = fightersData.length;
            fightersData = fightersData.filter(f => f.id !== 88888);
            
            if (fightersData.length < originalLength) {
                window.databaseSync.updateFighters(fightersData);
                log('âœ… ãƒ†ã‚¹ãƒˆé¸æ‰‹ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
                showResult('âœ… ãƒ†ã‚¹ãƒˆé¸æ‰‹ã‚’å‰Šé™¤ã—ã¾ã—ãŸ', 'success');
            } else {
                log('âš ï¸ å‰Šé™¤ã™ã‚‹ãƒ†ã‚¹ãƒˆé¸æ‰‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
                showResult('âš ï¸ å‰Šé™¤ã™ã‚‹ãƒ†ã‚¹ãƒˆé¸æ‰‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ', 'info');
            }
        }
        
        function checkSyncStatus() {
            if (!window.databaseSync) {
                showResult('âŒ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸã‚·ã‚¹ãƒ†ãƒ ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“', 'error');
                return;
            }
            
            const status = window.databaseSync.getSyncStatus();
            log('ç¾åœ¨ã®åŒæœŸçŠ¶æ…‹:');
            log(JSON.stringify(status, null, 2));
            showResult(`ğŸ“Š åŒæœŸçŠ¶æ…‹ã‚’ãƒ­ã‚°ã«å‡ºåŠ›ã—ã¾ã—ãŸ`, 'info');
            updateStatusCards();
        }
        
        function forceSyncCheck() {
            if (!window.databaseSync) {
                showResult('âŒ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸã‚·ã‚¹ãƒ†ãƒ ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“', 'error');
                return;
            }
            
            window.databaseSync.forceSyncCheck();
            showResult('ğŸ”„ å¼·åˆ¶åŒæœŸãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œã—ã¾ã—ãŸ', 'info');
            updateStatusCards();
        }
        
        function startRealtimeMonitor() {
            if (monitorInterval) {
                clearInterval(monitorInterval);
            }
            
            monitorInterval = setInterval(() => {
                updateStatusCards();
            }, 1000);
            
            log('ğŸ“¡ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–ã‚’é–‹å§‹ã—ã¾ã—ãŸ');
            showResult('ğŸ“¡ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–é–‹å§‹', 'info');
        }
        
        function stopRealtimeMonitor() {
            if (monitorInterval) {
                clearInterval(monitorInterval);
                monitorInterval = null;
            }
            
            log('â¹ï¸ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–ã‚’åœæ­¢ã—ã¾ã—ãŸ');
            showResult('â¹ï¸ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–åœæ­¢', 'info');
        }
        
        function clearLog() {
            testLog = [];
            document.getElementById('test-log').textContent = '';
            document.getElementById('test-results').innerHTML = '';
        }
        
        // åˆæœŸåŒ–å®Ÿè¡Œ
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(initialize, 500);
            
            // è‡ªå‹•ç›£è¦–é–‹å§‹
            setTimeout(startRealtimeMonitor, 1000);
        });
        
        // ãƒšãƒ¼ã‚¸é›¢è„±æ™‚ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
        window.addEventListener('beforeunload', () => {
            if (monitorInterval) {
                clearInterval(monitorInterval);
            }
        });
    </script>
</body>
</html>